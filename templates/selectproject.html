<!DOCTYPE html>
<html lang="zh-Hant" class="material-style layout-fixed">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}NHRI - 臨床研究數據平台{% endblock %}</title>

    <!-- Empire 核心 CSS -->
     <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/bootstrap-material.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/shreerang-material.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/uikit.css') }}"> 

    <!-- 你原本的其他樣式（如有衝突可逐步關閉測試） -->

    <link rel="stylesheet" href="{{ url_for('static', filename='Content/css/selectproject.css') }}"> 
    <!-- Icon Fonts -->
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/fonts/ionicons.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/fonts/feather.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='Content/font/bootstrap-icons.css') }}">

    {% block styles %}


    {% endblock %}
</head>

<body>

    <!-- Pre-loader -->
    <div class="page-loader">
        <div class="bg-primary"></div>
    </div>

    <section>

      <div class="flex min-h-screen flex-col items-center justify-center bg-slate-100 p-6 fade-in">
        <div class="mb-10 text-center">
          <div class="h-16 w-16 leading-none mb-4 inline-flex items-center justify-center rounded-full bg-blue-600 p-4 shadow-lg shadow-blue-500/30">
            <i id="bi-activity-inSP" class="bi bi-activity"></i>
          </div>
          <h1 class="text-3xl font-bold text-slate-900">NHRI - 臨床研究數據平台</h1>
          <p class="mt-2 text-slate-500">Clinical Research Data Platform</p>
        </div>
        <div class="w-full max-w-4xl">
          <h2 class="mb-6 text-xl font-semibold text-slate-800">請選擇您的計畫案 (Project)</h2>

            <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
            {% for d in data %}

                <button class="group relative flex flex-col rounded-xl border border-slate-200 bg-white p-6 text-left shadow-sm transition-all hover:-translate-y-1 hover:border-blue-300 hover:shadow-xl hover:shadow-blue-500/10" onclick="window.location.href='{{ url_for('pages.set_study_session', study_id=d['study_info'].ProjectId, study_name=d['study_info'].ProjectName) }}'">
                <div class="mb-4 flex items-start justify-between">
                    <div class="rounded-lg bg-blue-50 p-3 text-blue-600 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                      <i class="sidenav-icon feather icon-folder" style="font-size: 1.5rem;"></i>
                      </div>
                      <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium bg-emerald-100 text-emerald-800">{{d['study_info'].ProjectStatus}}</span>
                    </div>
                    <h3 class="mb-2 text-lg font-bold text-slate-900">{{d['study_info'].ProjectId}}</h3>
                    <p class="mb-4 line-clamp-2 text-sm text-slate-600">{{d['study_info'].ProjectName}}</p>
                    <div class="mt-auto border-t border-slate-100 pt-4">
                      <div class="flex items-center justify-between text-xs text-slate-500">
                        <span>PI: {{d['pi_name']}}</span>
                        <span>{{d['SubjectCount']}} 人收案</span></div>
                        <div class="mt-4 flex items-center gap-1 text-sm font-medium text-blue-600 opacity-0 transition-opacity group-hover:opacity-100">進入計畫 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4">
                          <path d="M5 12h14"></path>
                          <path d="m12 5 7 7-7 7"></path>
                        </svg>
                      </div>
                    </div>
                  </button>
              {% endfor %}

            </div>
            <p class="mt-12 text-sm text-slate-400">© 2024 NHRI. All rights reserved.</p>
          </div>
      </div>
    </section>
    

    <!-- JS 資源（順序很重要） -->
    <script src="{{ url_for('static', filename='assets/css/tailwindcss.css') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/jquery-4.0.0.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/libs/popper/popper.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/bootstrap.js') }}"></script>

    <script src="{{ url_for('static', filename='assets/js/layout-helpers.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/sidenav.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/material-ripple.js') }}"></script>


    <!-- 初始化 Empire layout + 額外保險的伸縮事件 -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            if (window.layoutHelpers) {
                window.layoutHelpers.init();
            }

            // 額外保險：任何 .layout-sidenav-toggle 被點擊時，切換側欄收合/展開
            document.querySelectorAll('.layout-sidenav-toggle').forEach(function (el) {
                el.addEventListener('click', function () {
                    if (window.layoutHelpers && typeof window.layoutHelpers.toggleCollapsed === 'function') {
                        window.layoutHelpers.toggleCollapsed();
                    }
                });
            });
        });
    </script>

    {% block scripts %}{% endblock %}
</body>

</html>